{"ast":null,"code":"var _jsxFileName = \"/Users/jonathandennis/MOOC_fullStack/part5/bloglist-frontend/src/App.js\";\nimport React, { useState, useEffect } from 'react';\nimport Blog from './components/Blog';\nimport Notification from './components/Notification';\nimport BlogForm from './components/BlogForm';\nimport LoginForm from './components/LoginForm';\nimport Footer from './components/Footer';\nimport blogService from './services/blogs';\nimport loginService from './services/login';\nimport { initializeBlogs } from './reducers/blogReducer';\nimport { initializeUser } from './reducers/loginReducer';\nimport { setNotification } from './reducers/notificationReducer';\nimport { useDispatch, useSelector } from 'react-redux';\n\nconst App = () => {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState(''); //const [user, setUser] = useState(null)\n\n  const dispatch = useDispatch();\n  const blogs = useSelector(state => state.blogs);\n  const user = useSelector(state => state.user);\n  useEffect(() => {\n    dispatch(initializeBlogs());\n  }, [dispatch]);\n  useEffect(() => {\n    dispatch(initializeUser());\n  }, [dispatch]); // useEffect(() => {\n  //   const loggedUserJSON = window.localStorage.getItem('loggedBlogappUser')\n  //   if (loggedUserJSON) {\n  //     const user = JSON.parse(loggedUserJSON)\n  //     setUser(user)\n  //     blogService.setToken(user.token)\n  //   }\n  // }, [])\n\n  const handleLogin = async event => {\n    event.preventDefault();\n    console.log('logging in with', username, password);\n\n    try {\n      const user = await loginService.login({\n        username,\n        password\n      });\n      window.localStorage.setItem('loggedBlogappUser', JSON.stringify(user));\n      blogService.setToken(user.token); //setUser(user)\n\n      setUsername('');\n      setPassword('');\n    } catch (error) {\n      dispatch(setNotification('Wrong username or password', 5)); //notify('Wrong username or password')\n\n      setUsername('');\n      setPassword('');\n    }\n  };\n\n  const handleLogout = async () => {\n    window.localStorage.removeItem('loggedBlogappUser', JSON.stringify(user)); //setUser(null)\n\n    dispatch(setNotification(`${user.name} has been sucessfully logged out.`, 5)); //notify(`${user.name} has been sucessfully logged out.`, 'ok')\n  };\n\n  const loginForm = () => /*#__PURE__*/React.createElement(LoginForm, {\n    username: username,\n    password: password,\n    handleUsernameChange: ({\n      target\n    }) => setUsername(target.value),\n    handlePasswordChange: ({\n      target\n    }) => setPassword(target.value),\n    handleSubmit: handleLogin,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 5\n    }\n  });\n\n  if (user === null) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Notification, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }\n    }), loginForm(), /*#__PURE__*/React.createElement(Footer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }\n    }));\n  }\n\n  const byLikes = (b1, b2) => b2.likes - b1.likes;\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }\n  }, \"blogs\"), /*#__PURE__*/React.createElement(Notification, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }\n  }, user.name, \" logged in  \", /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    onClick: handleLogout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 33\n    }\n  }, \"logout\")), /*#__PURE__*/React.createElement(BlogForm, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }\n  }), blogs.sort(byLikes).map(blog => /*#__PURE__*/React.createElement(Blog, {\n    key: blog.id,\n    user: user,\n    blog: blog,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default App;","map":{"version":3,"sources":["/Users/jonathandennis/MOOC_fullStack/part5/bloglist-frontend/src/App.js"],"names":["React","useState","useEffect","Blog","Notification","BlogForm","LoginForm","Footer","blogService","loginService","initializeBlogs","initializeUser","setNotification","useDispatch","useSelector","App","username","setUsername","password","setPassword","dispatch","blogs","state","user","handleLogin","event","preventDefault","console","log","login","window","localStorage","setItem","JSON","stringify","setToken","token","error","handleLogout","removeItem","name","loginForm","target","value","byLikes","b1","b2","likes","sort","map","blog","id"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport Blog from './components/Blog'\nimport Notification from './components/Notification'\nimport BlogForm from './components/BlogForm'\nimport LoginForm from './components/LoginForm'\nimport Footer from './components/Footer'\nimport blogService from './services/blogs'\nimport loginService from './services/login'\n\nimport { initializeBlogs } from './reducers/blogReducer'\nimport { initializeUser } from './reducers/loginReducer'\nimport { setNotification } from './reducers/notificationReducer'\nimport { useDispatch, useSelector } from 'react-redux'\n\nconst App = () => {\n  const [username, setUsername] = useState('')\n  const [password, setPassword] = useState('')\n  //const [user, setUser] = useState(null)\n\n  const dispatch = useDispatch()\n  const blogs = useSelector(state => state.blogs)\n  const user = useSelector(state => state.user)\n\n\n  useEffect(() => {\n    dispatch(initializeBlogs())\n  }, [dispatch])\n\n  useEffect(() => {\n    dispatch(initializeUser())\n  }, [dispatch])\n  // useEffect(() => {\n  //   const loggedUserJSON = window.localStorage.getItem('loggedBlogappUser')\n  //   if (loggedUserJSON) {\n  //     const user = JSON.parse(loggedUserJSON)\n  //     setUser(user)\n  //     blogService.setToken(user.token)\n  //   }\n  // }, [])\n\n  const handleLogin = async (event) => {\n    event.preventDefault()\n    console.log('logging in with', username, password)\n\n    try {\n      const user = await loginService.login({\n        username, password,\n      })\n\n      window.localStorage.setItem(\n        'loggedBlogappUser', JSON.stringify(user)\n      )\n      blogService.setToken(user.token)\n      //setUser(user)\n      setUsername('')\n      setPassword('')\n    } catch (error) {\n      dispatch(setNotification('Wrong username or password', 5))\n      //notify('Wrong username or password')\n      setUsername('')\n      setPassword('')\n    }\n  }\n\n  const handleLogout = async () => {\n    window.localStorage.removeItem(\n      'loggedBlogappUser', JSON.stringify(user)\n    )\n    //setUser(null)\n    dispatch(setNotification(`${user.name} has been sucessfully logged out.`, 5))\n    //notify(`${user.name} has been sucessfully logged out.`, 'ok')\n  }\n\n  const loginForm = () => (\n    <LoginForm\n      username={username}\n      password={password}\n      handleUsernameChange={({ target }) => setUsername(target.value)}\n      handlePasswordChange={({ target }) => setPassword(target.value)}\n      handleSubmit={handleLogin}\n    />\n  )\n\n  if (user === null) {\n    return (\n      <div>\n        <Notification />\n        {loginForm()}\n        <Footer />\n      </div>\n    )\n  }\n\n  const byLikes = (b1, b2) => b2.likes - b1.likes\n\n  return (\n    <div>\n      <h2>blogs</h2>\n\n      <Notification />\n\n      <p>{user.name} logged in  <button type=\"submit\" onClick={handleLogout}>logout</button></p>\n\n      <BlogForm />\n      {blogs.sort(byLikes).map(blog =>\n        <Blog\n          key={blog.id}\n          user={user}\n          blog={blog}\n\n        />\n      )}\n      <Footer />\n    </div>\n  )\n}\n\nexport default App"]},"metadata":{},"sourceType":"module"}